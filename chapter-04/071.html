<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>071 - hacker.fix(system);</title><link rel="stylesheet" href="/magi-hacker/bower/bootstrap.min.css"><link rel="stylesheet" href="/magi-hacker/assets/style.css"></head><body class="page page-chapter-04-071 page-novel"><nav class="global-nav navbar navbar-default navbar-fixed-top"><div class="container"><div class="navbar-header"><button data-toggle="collapse" data-target="#global-navbar" aria-expanded="false" class="navbar-toggle collapsed"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/magi-hacker/" class="navbar-brand"><img src="/magi-hacker/images/logo.png" alt="マギハッカーの異世界ベンチャー起業術" height="100%"></a></div><div id="global-navbar" class="collapse navbar-collapse"><ul class="nav navbar-nav"><li><a href="/magi-hacker/SUMMARY.html">目次</a></li><li><a href="/magi-hacker/GLOSSARY.html">用語集</a></li></ul><ul class="nav navbar-nav navbar-right"><li><a href="https://github.com/io-monad/magi-hacker">GitHub</a></li><li><a href="http://ncode.syosetu.com/n5191dd/">小説家になろうで読む</a></li><li><a href="https://kakuyomu.jp/works/4852201425154996024">カクヨムで読む</a></li></ul></div></div></nav><main><div class="container"><h1>
  <a name="071-hacker-fix-system" id="071-hacker-fix-system" class="anchor"></a>
  071 - hacker.fix(system);
</h1><p><span class="paragraph"><a name="L3" id="L3" class="anchor"></a>「自分の幸福を追求して何が悪いというのです？　人は幸せになる権利があり、義務があるのですよ」</span></p>
<p><span class="paragraph"><a name="L5" id="L5" class="anchor"></a>　突然現れた『教皇様』をチラリと見ると、そこには手を広げた『子供』が立っていた。</span></p>
<p><span class="paragraph sticky"><a name="L7" id="L7" class="anchor"></a>　いや、違う。どうやら『小人族』の男性のようだ。珍しい銀色の髪を肩より下に長く伸ばし、教会でお馴染みの黒いローブを身に着けている。ただ、他の関係者のローブに比べると、ところどころにワンポイントの刺繍や金糸での上品な飾りが入っており、豪華な雰囲気だ。</span>
<span class="paragraph sticky"><a name="L8" id="L8" class="anchor"></a>　男性のはずなのにやけに高い声だったから不思議だったが、小人族なら理解できる。彼らは大人になっても、ヒト族における１０歳ごろの見た目を保っているのだ。当然、変声期など存在しない。</span>
<span class="paragraph"><a name="L9" id="L9" class="anchor"></a>　教皇は子供の見た目ながら異常な美形であり、人形めいた印象を受ける。形だけは柔和な笑みを浮かべているのだが、どことなく冷めた感じというか、血が通っていないというか、あまり良い印象は無い。しかし、何万人もの信者を束ねるリンター教のトップなのだ。きっといざという時は威厳とカリスマ性を発揮するのだろう。</span></p>
<p><span class="paragraph sticky"><a name="L11" id="L11" class="anchor"></a>「仮に高い利用料で不幸になる人が<ruby>多<rp> (</rp><rt>・</rt><rp>)</rp></ruby><ruby>少<rp> (</rp><rt>・</rt><rp>)</rp></ruby>いようとも、それを貴女が気に病む必要などありません。貴女はこれまで多くの人を救ってきた。貴女によって救われた人の数を考えれば、物の数には入らないのですから、ね？」</span>
<span class="paragraph sticky"><a name="L12" id="L12" class="anchor"></a>「で、ですが、人の幸不幸を数の大小で考えるべきでは……」</span>
<span class="paragraph sticky"><a name="L13" id="L13" class="anchor"></a>「ふふ……、いえ、失礼。貴女があまりにも真っ直ぐだったもので。しかし、こう考えてみてはいかがでしょう？　我々は富める者から貧しい者達へと<ruby>富<rp> (</rp><rt>・</rt><rp>)</rp></ruby><ruby>の<rp> (</rp><rt>・</rt><rp>)</rp></ruby><ruby>再<rp> (</rp><rt>・</rt><rp>)</rp></ruby><ruby>分<rp> (</rp><rt>・</rt><rp>)</rp></ruby><ruby>配<rp> (</rp><rt>・</rt><rp>)</rp></ruby>をしているのだと。我々がいなければ治療マギサービスは存在せず、富める者は病に怯え、貧しき者は貧しさに飢えてしまいます。我々がいたからこそ、富める者は病に怯える事もなくなり喜んで富を差し出し、貧しき者達は施しを受ける事ができるのです。ほら、誰も不幸になどなってはいないではないですか」</span>
<span class="paragraph"><a name="L14" id="L14" class="anchor"></a>「そ、それは……」</span></p>
<p><span class="paragraph"><a name="L16" id="L16" class="anchor"></a>　シスターは言葉に詰まっている。確かにマギサービスが存在する事で経済が循環しているという側面もあるだろう。娯楽の少ない世界だから、どこかで高額な商品やサービスを売りつけないと、富は高所得者に集中したままだ。</span></p>
<p><span class="paragraph sticky"><a name="L18" id="L18" class="anchor"></a>「でも、それって詭弁ですよね」</span>
<span class="paragraph"><a name="L19" id="L19" class="anchor"></a>「ほう？」</span></p>
<p><span class="paragraph"><a name="L21" id="L21" class="anchor"></a>　思わずポロリと口からこぼれた言葉に、教皇はグリンと首を回して反応する。やはりどこか人形のようで、ガラスのように青く澄んだ瞳で見つめられると居心地が悪くなる。</span></p>
<p><span class="paragraph sticky"><a name="L23" id="L23" class="anchor"></a>「高い利用料を取るのは別に治療マギサービスでなくてもいいはずです。他のマギサービスならともかく、治療マギサービスは生命に直結するものなんですから、水生成などと同様に安価で提供されるべきですよ」</span>
<span class="paragraph sticky"><a name="L24" id="L24" class="anchor"></a>「ははは。面白いことをいいますね。それはつまり、我々に『国営』となれと言っているのに等しいですよ？　つまりダイナ王国は国として宗教を運用する、立派な宗教国家となるわけですね。ふふふ。私もそれは望むところです」</span>
<span class="paragraph sticky"><a name="L25" id="L25" class="anchor"></a>「い、いえ、そうではなくて、治療マギサービスを王国が運営すればどうかと言っているのですが……」</span>
<span class="paragraph"><a name="L26" id="L26" class="anchor"></a>「そうなれば、リンター教は教義の中心である治療マギサービスを失う事になり、多くの人々が信仰を失うでしょう。心の拠り所を失った人々が、今より不幸でないと誰が言えるでしょうか？」</span></p>
<p><span class="paragraph sticky"><a name="L28" id="L28" class="anchor"></a>　ダメだ。ああいえばこういうタイプで、全く通用する気がしない。</span>
<span class="paragraph"><a name="L29" id="L29" class="anchor"></a>　細かく突き詰めれば論理的におかしい部分もわかるのだろうが、人形めいた姿と笑っているのに目が笑っていない顔のせいで全く集中できない。</span></p>
<p><span class="paragraph sticky"><a name="L31" id="L31" class="anchor"></a>「それより、手が止まっていますよ？　治療マギサービスの復旧は至上命題です。傷ついて倒れている者たちのためにも、一刻でも早い復旧をお願いしたいですね」</span>
<span class="paragraph"><a name="L32" id="L32" class="anchor"></a>「は、はい。すみません……」</span></p>
<p><span class="paragraph"><a name="L34" id="L34" class="anchor"></a>　もやもやとした気持ちになりつつも、言っている事は間違いないのでコードに集中する。人形のような顔が頭に浮かんでは消えていったが、次第に集中を深めていった。</span></p>
<hr>
<p><span class="paragraph"><a name="L38" id="L38" class="anchor"></a>　治療マギサービスのコードは大きく２つに分けられる事がわかった。</span></p>
<p><span class="paragraph sticky"><a name="L40" id="L40" class="anchor"></a>　１つは実際に人々を治療する部分。やはりこちらが一番巨大なコードとなっている。複雑なコードも大部分はここだ。模倣を疑われると心配していたのだが、これでは模倣すら容易ではないだろう。</span>
<span class="paragraph"><a name="L41" id="L41" class="anchor"></a>　そしてもう１つが――</span></p>
<p><span class="paragraph sticky"><a name="L43" id="L43" class="anchor"></a>「うーん、こりゃあ刷新も必要になるよなぁ」</span>
<span class="paragraph"><a name="L44" id="L44" class="anchor"></a>「なんというか……なんでわざわざ人の手を通すようになってるんでしょう？」</span></p>
<p><span class="paragraph sticky"><a name="L46" id="L46" class="anchor"></a>　マギサービスの管理、つまり利用者のＩＤにあたるマギフィンガープリントの管理や売上の計算などを行なうための部分だ。そして今回のコンペで刷新の対象とされた部分でもある。といっても、そのコード量は治療のためのコードに比べれば非常に少ない。</span>
<span class="paragraph"><a name="L47" id="L47" class="anchor"></a>　せっかくのマギシステムだというのにほとんど自動化されておらず、人の手が必要になるようになっている。登録所での利用登録が手動で行われる事から始まり、売上の計算も、それに使う利用回数の計測すら人力で行われているようだ。</span></p>
<p><span class="paragraph sticky"><a name="L49" id="L49" class="anchor"></a>　驚いたのが、「マギの発動」ですら人の手が介される事である。</span>
<span class="paragraph sticky"><a name="L50" id="L50" class="anchor"></a>　マギサービスというのは、利用者がマギを発動しようとすると「マギを発動したいというリクエスト」を受け取る事になる。このリクエストに応じて、利用者のマギデバイスを通してマギを発動させるのだ。</span>
<span class="paragraph sticky"><a name="L51" id="L51" class="anchor"></a>　いつくるかもわからないリクエストを待ち続けるなんて無理なので、僕の場合は当然ながら自動化している。しかし、治療マギサービスにおいてはその無理を通して理屈を引っ込めさせたらしい。どうやら、２４時間人が張り付いて、リクエストに応じてマギを発動させているようなのだ。</span>
<span class="paragraph"><a name="L52" id="L52" class="anchor"></a>　そりゃあ、マギサービスの運営に多くの人が必要になるのもわかるし、利用者が増えてくれば限界が出てくるのも当然だ。</span></p>
<p><span class="paragraph sticky"><a name="L54" id="L54" class="anchor"></a>「うーん、これは、治療する部分と、管理する部分を作ったのは別の人なんだろうな。明らかにコードの質が違う。治療する方は非常に複雑だけどいちおう構造化はしてるし、マギランゲージの変わった書き方まで駆使して書かれてるから、かなりマギランゲージに精通した人が書いたのは間違いないね」</span>
<span class="paragraph sticky"><a name="L55" id="L55" class="anchor"></a>「はい。師匠に会う前の私なら、こういうコードを書いてたかも……」</span>
<span class="paragraph sticky"><a name="L56" id="L56" class="anchor"></a>「ははは。それと比べると、管理部分は明らかに治療部分を見よう見まねで書いたとしか思えないな。構造化も中途半端でところどころルールを逸脱してるし、大した事をやってないのにやたらと複雑になっている」</span>
<span class="paragraph"><a name="L57" id="L57" class="anchor"></a>「教科書とかで良く見かける書き方ですね……」</span></p>
<p><span class="paragraph"><a name="L59" id="L59" class="anchor"></a>　ちなみに『構造化』というのは定義が様々であるが、ここではプログラムをいくつかの『<ruby>層<rp> (</rp><rt>レイヤー</rt><rp>)</rp></ruby>』にわけて書く事を言っている。プログラムの表層に近ければ近いほど抽象度が高くなっていき、逆に層が深くなればなるほど書かれた処理は具体的になっていく。</span></p>
<p><span class="paragraph sticky"><a name="L61" id="L61" class="anchor"></a>　例えば、インターネットの通販サイトで何か物を買った時に行われる処理が、どのように構造化されるか想像してみる。一番上の層では「○○という物を買う」という抽象的な処理が書かれているだろう。</span>
<span class="paragraph sticky"><a name="L62" id="L62" class="anchor"></a>　次の層では少し具体的になって「○○という物の値段を得る」「クレジットカードで代金を決済する」「○○を買った人に発送する」といった処理が書かれるだろう。</span>
<span class="paragraph sticky"><a name="L63" id="L63" class="anchor"></a>　さらに次の層ではもっと具体的に「データベースに○○という名前の商品の値段を問い合わせる」「カード会社に通信して決済を依頼する」「発送システムに送り先情報と商品情報を登録する」といった処理が書かれているはずだ。</span>
<span class="paragraph"><a name="L64" id="L64" class="anchor"></a>　このように層を分けることで抽象度を高める事ができ、各層でやるべき事に集中する事ができるなどメリットは多い。例えば後から「対応するクレジットカード会社を増やしたい」という追加依頼が来ても、物を買う処理の中で修正するのはカード会社と通信している層だけで良いのだ。上手く構造化されていれば、修正範囲をきちんと切り分ける事ができる。</span></p>
<p><span class="paragraph sticky"><a name="L66" id="L66" class="anchor"></a>　しかし、管理部分の方は構造化のルールを逸脱していて、処理の具体度もまちまちだったり、層がきちんと切り分けられておらず、混在していたりする。これでは無駄に複雑で混乱を招くだけだ。</span>
<span class="paragraph"><a name="L67" id="L67" class="anchor"></a>　残念ながら、こういった「間違った構造化」が当たり前となっているのが現在の一般的なマギエンジニアなのだ。これでは書いた端からスパゲッティコードになってしまうのも仕方ない。</span></p>
<p><span class="paragraph sticky"><a name="L69" id="L69" class="anchor"></a>「で、肝心の停止している原因なんだけど」</span>
<span class="paragraph sticky"><a name="L70" id="L70" class="anchor"></a>「うーん、私の方は見つかりませんでした……」</span>
<span class="paragraph sticky"><a name="L71" id="L71" class="anchor"></a>「僕の方はね、それらしいところがあったんだ」</span>
<span class="paragraph"><a name="L72" id="L72" class="anchor"></a>「えっ！　本当ですか？」</span></p>
<p><span class="paragraph"><a name="L74" id="L74" class="anchor"></a>　驚いたパールに問題のコードを示してみせる。それは、保存されているマギフィンガープリントの一覧を読み込む部分の処理だった。起動時には必ず通る場所だ。</span></p>
<p><span class="paragraph sticky"><a name="L76" id="L76" class="anchor"></a>「うーん、別におかしいところはないような……」</span>
<span class="paragraph sticky"><a name="L77" id="L77" class="anchor"></a>「うん。だけどね、この処理は『異常なマギフィンガープリント』が存在する事を想定していないんだよ。全部が正常なマギフィンガープリントだと仮定して書かれているわけだね」</span>
<span class="paragraph sticky"><a name="L78" id="L78" class="anchor"></a>「え？　それって当たり前なんじゃないんですか？」</span>
<span class="paragraph"><a name="L79" id="L79" class="anchor"></a>「確かに普通はそうだ。『異常なマギフィンガープリント』が保存されているはずがないからね。だけど……これを見て」</span></p>
<p><span class="paragraph"><a name="L81" id="L81" class="anchor"></a>　そう言って示したのは、マギフィンガープリントの一覧データ。ぼんやりと明るいスクリーンの光を、パールのメガネが反射する。</span></p>
<p><span class="paragraph sticky"><a name="L83" id="L83" class="anchor"></a>「えっ……！？　な、なんですか、これ！」</span>
<span class="paragraph sticky"><a name="L84" id="L84" class="anchor"></a>「明らかにおかしいだろ？　マギフィンガープリントは長い桁数の数字のはずだけど、これは<ruby>空<rp> (</rp><rt>・</rt><rp>)</rp></ruby><ruby>っ<rp> (</rp><rt>・</rt><rp>)</rp></ruby><ruby>ぽ<rp> (</rp><rt>・</rt><rp>)</rp></ruby><ruby>の<rp> (</rp><rt>・</rt><rp>)</rp></ruby><ruby>デ<rp> (</rp><rt>・</rt><rp>)</rp></ruby><ruby>ー<rp> (</rp><rt>・</rt><rp>)</rp></ruby><ruby>タ<rp> (</rp><rt>・</rt><rp>)</rp></ruby>だ。空っぽのデータをマギフィンガープリントとして扱う事なんて出来るわけがないよね」</span>
<span class="paragraph"><a name="L85" id="L85" class="anchor"></a>「は、はい。これじゃあ途中で処理が失敗して止まっちゃいそうです」</span></p>
<p><span class="paragraph"><a name="L87" id="L87" class="anchor"></a>　というわけで、すぐに修正してみる事にした。少し緊張しながら、該当のデータを削除し、再起動を試みる。すると、マギデバイスが光り輝き、正常に治療マギサービスが開始した事がわかった。</span></p>
<p><span class="paragraph sticky"><a name="L89" id="L89" class="anchor"></a>「やった……！　直ったぞ！」</span>
<span class="paragraph"><a name="L90" id="L90" class="anchor"></a>「やりましたね！　さすが師匠ですっ！」</span></p>
<p><span class="paragraph"><a name="L92" id="L92" class="anchor"></a>　僕達がそう声をあげると、周囲からも歓声があがる。直った事を知らせるため、すぐに数人が部屋を飛び出していく。</span></p>
<p><span class="paragraph"><a name="L94" id="L94" class="anchor"></a>「シライシさん……本当に、感謝いたします」</span></p>
<p><span class="paragraph"><a name="L96" id="L96" class="anchor"></a>　シスター・エイダが膝をついて手を組み、大げさに感謝を告げる。まるで豊穣をもたらした神に感謝するような態度だ。偉くもないのに偉くなった気分になるのでやめてほしい。</span></p>
<p><span class="paragraph"><a name="L98" id="L98" class="anchor"></a>　パチパチパチ、と音がしたので目を向けると、教皇が拍手をしていた。拍手の意味はこちらの世界でも変わりはない。賞賛を送るために使われる。</span></p>
<p><span class="paragraph sticky"><a name="L100" id="L100" class="anchor"></a>「お見事、お見事。さすがマギハッカーの再来と呼ばれるだけの事はありますね」</span>
<span class="paragraph sticky"><a name="L101" id="L101" class="anchor"></a>「い、いえ……僕には過ぎた称号ですが」</span>
<span class="paragraph sticky"><a name="L102" id="L102" class="anchor"></a>「ふふふ、謙遜は美徳ではありますが、過度な謙遜は時に人を傷つけます。注意することですよ」</span>
<span class="paragraph sticky"><a name="L103" id="L103" class="anchor"></a>「は、はぁ……」</span>
<span class="paragraph sticky"><a name="L104" id="L104" class="anchor"></a>「それにしても、停止の原因は何だったのでしょう？　もう一度停止する可能性もあるのでしょうか？」</span>
<span class="paragraph"><a name="L105" id="L105" class="anchor"></a>「あ、それなのですが」</span></p>
<p><span class="paragraph"><a name="L107" id="L107" class="anchor"></a>　空のマギフィンガープリントの事を教皇とシスター達に説明する。シスター達はなんとなく理解したようだったが、たった１つの空のデータが登録されていただけでシステム全体が止まってしまうという事が、ピンと来ない様子だった。</span></p>
<p><span class="paragraph sticky"><a name="L109" id="L109" class="anchor"></a>「なるほどなるほど。空のマギフィンガープリントですか。果たしてそれは、一体どのようにして登録されたんでしょうね？」</span>
<span class="paragraph sticky"><a name="L110" id="L110" class="anchor"></a>「わかりません……が、少なくとも登録所に詰めている職員によるものではないと思います」</span>
<span class="paragraph sticky"><a name="L111" id="L111" class="anchor"></a>「ほう？　どうしてそう言い切れるのですか？」</span>
<span class="paragraph sticky"><a name="L112" id="L112" class="anchor"></a>「マギフィンガープリントが登録される経路には２種類あるのがわかります。１つは登録所の職員達が利用する『管理画面』経由でのもの。こちらは登録時に空のマギフィンガープリントは弾かれるようになっています」</span>
<span class="paragraph sticky"><a name="L113" id="L113" class="anchor"></a>「となると、もう１つの経路が怪しいというわけですね」</span>
<span class="paragraph"><a name="L114" id="L114" class="anchor"></a>「はい。といっても、本来なら使われるはずのない経路なんです。こちらは恐らく『デバッグ用』、つまり開発者がマギシステムの動作を確認するために使うものでしょう。本番で稼働する際に消し忘れていたのではないかな、と……」</span></p>
<p><span class="paragraph"><a name="L116" id="L116" class="anchor"></a>　管理部分を作成したマギエンジニアのミスである。といっても、よくあるミスなのだ。デバッグのために一時的にコードを追加する事はよくある。それを消し忘れてしまうというのもありがちなポカだ。</span></p>
<p><span class="paragraph sticky"><a name="L118" id="L118" class="anchor"></a>「なるほど。そのような『裏口』が存在していたのですね」</span>
<span class="paragraph"><a name="L119" id="L119" class="anchor"></a>「はい。ただ、この存在はマギシステムのソースコードを読まない限りはわからないはずなのですが」</span></p>
<p><span class="paragraph"><a name="L121" id="L121" class="anchor"></a>　空のデータを登録した誰かは、ソースコードを読んでこの『裏口』の存在を知ったのだろう。『裏口』経由の登録は遠隔で呼び出す事もできるため、犯人を特定する事は難しいのだが……。</span></p>
<p><span class="paragraph"><a name="L123" id="L123" class="anchor"></a>「ふふふ。シライシさん。何やらお考えがあるようですね？」</span></p>
<p><span class="paragraph sticky"><a name="L125" id="L125" class="anchor"></a>　教皇にはお見通しだったらしい。その顔は先程の人形めいた笑顔ではなく、少しイタズラっぽい子供のような笑顔だ。</span>
<span class="paragraph"><a name="L126" id="L126" class="anchor"></a>　僕はゆっくりとうなずいて、教皇に答える。</span></p>
<p><span class="paragraph"><a name="L128" id="L128" class="anchor"></a>「はい。もしかしたら<ruby>犯<rp> (</rp><rt>・</rt><rp>)</rp></ruby><ruby>人<rp> (</rp><rt>・</rt><rp>)</rp></ruby><ruby>が<rp> (</rp><rt>・</rt><rp>)</rp></ruby><ruby>わ<rp> (</rp><rt>・</rt><rp>)</rp></ruby><ruby>か<rp> (</rp><rt>・</rt><rp>)</rp></ruby><ruby>る<rp> (</rp><rt>・</rt><rp>)</rp></ruby>かもしれません」</span></p>
</div></main><div class="container"><nav class="page-nav"><ul class="pager"><li class="previous"><a href="/magi-hacker/chapter-04/070.html">前: 070 - hacker.struggle();</a></li><li class="next"><a href="/magi-hacker/chapter-04/072.html">次: 072 - hacker.set(trap);</a></li></ul></nav></div><footer><div class="container"><p>&copy; Copyright 2016 IRIDE Monad</p></div></footer><script src="/magi-hacker/bower/jquery.js" charset="utf-8"></script><script src="/magi-hacker/bower/bootstrap.min.js" charset="utf-8"></script><script src="/magi-hacker/assets/page.js" charset="utf-8"></script></body></html>